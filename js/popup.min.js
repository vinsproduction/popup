var Popup,popup;window.console||(window.console={}),window.console.log||(window.console.log=function(){}),window.console.warn||(window.console.warn=window.console.log),Popup=function(){function Popup(){var self;self=this,$(function(){self.$popups=$(self.selectors.popups),self.$popup=self.$popups.find(self.selectors.popup),self.$close=self.$popups.find(self.selectors.close),self.mobileBrowser&&self.$popups.addClass(self.classes.mobile),self.$popup.each(function(){var el,name;el=$(this),name=el.attr("data-popup-name"),el.find("."+self.classes.inner).size()||$(this).wrapInner("<div class='"+self.classes.inner+"'></div>"),self.popups[name]={name:name,el:el,inner:el.find("."+self.classes.inner)},el.find(self.selectors.button).click(function(){return self.active&&(self.popups[self.active].opt.buttonClick?self.popups[self.active].opt.buttonClick():self.popups[self.active].opt.close&&self.close()),!1})}),self.$popups.find(self.selectors.close).click(function(){return self.active&&self.popups[self.active].opt.close&&self.close(self.active),!1}),self.$popups.click(function(event){self.active&&self.popups[self.active].opt.close&&($(event.target).closest(self.popups[self.active].inner).length||$(event.target).is(self.popups[self.active].inner)||self.close(self.active))}),$(window).resize(function(){return self.active?self.position(self.popups[self.active]):void 0}),self.logs&&console.log("[Popup] init",self.popups)})}return Popup.prototype.logs=!0,Popup.prototype.popups={},Popup.prototype.active=!1,Popup.prototype.options={top:"auto",left:"auto",right:"auto",bottom:"auto",close:!0,fade:300,buttonClick:!1,title:"",body:"",button:"Закрыть"},Popup.prototype.selectors={popups:"#popups",popup:"[data-popup-name]",close:"[data-popup-close]",button:"[data-popup-button]",custom:{title:"[data-popup-title]",body:"[data-popup-body]",button:"[data-popup-button-name]"}},Popup.prototype.classes={inner:"inner",closeDisabled:"popup-close-disabled",popupOpen:"popup-open",mobile:"popup-mobile"},Popup.prototype.mobileBrowser=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),Popup.prototype.position=function(popup){var css,el,inner,left,name,opt,popupHeight,popupWidth,self,top,windowHeight,windowScroll,windowWidth;self=this,name=popup.name,el=popup.el,opt=popup.opt,inner=popup.inner,windowWidth=null!=window.innerWidth?innerWidth:$(window).width(),windowHeight=null!=window.innerHeight?innerHeight:$(window).height(),popupHeight=inner.outerHeight(),popupWidth=inner.outerWidth(),windowScroll=$(window).scrollTop(),top=windowHeight/2-popupHeight/2+windowScroll,0>top&&(top=0),left=windowWidth/2-popupWidth/2,0>left&&(left=0),css={},"auto"!==opt.bottom?css.bottom=opt.bottom:"auto"!==opt.top?css.top=opt.top:css.top=top,"auto"!==opt.right?css.right=opt.right:"auto"!==opt.left?css.left=opt.left:css.left=left,popupWidth>windowWidth&&(css.width=windowWidth),inner.css(css),el.css({height:popupHeight>windowHeight?popupHeight:windowHeight,width:windowWidth})},Popup.prototype.open=function(name,opt){var self;null==opt&&(opt={}),self=this,$(function(){return name&&self.popups[name]?(self.active&&self.close(),self.popups[name].opt=$.extend(!0,{},self.options,opt),setTimeout(function(){self.active=name,self.popups[name].el.find(self.selectors.custom.title).html(self.popups[name].opt.title),self.popups[name].el.find(self.selectors.custom.body).html(self.popups[name].opt.body),self.popups[name].el.find(self.selectors.custom.button).html(self.popups[name].opt.button),self.popups[name].el.show(),self.$popups.stop().fadeIn(self.popups[name].opt.fade),self.popups[name].el.addClass(self.classes.popupOpen),self.popups[name].opt.close||self.popups[name].el.addClass(self.classes.closeDisabled),$("body").addClass(self.classes.popupOpen),self.position(self.popups[name]),self.logs&&console.log("[Popup] open",self.popups[name]),self.$popup.eq(0).trigger("open",[self.popups[name]])},0)):!1})},Popup.prototype.close=function(){var self;self=this,$(function(){var name;self.active?(name=self.active,self.$popups.stop().hide(),self.popups[name].el.hide(),self.popups[name].el.removeClass(self.classes.popupOpen),self.popups[name].el.removeClass(self.classes.closeDisabled),$("body").removeClass(self.classes.popupOpen),self.logs&&console.log("[Popup] close",self.popups[name]),self.$popup.eq(0).trigger("close",[self.popups[name]])):(self.$popup.hide(),self.$popups.hide(),self.$popup.removeClass(self.classes.closeDisabled),self.$popup.removeClass(self.classes.popupOpen),self.$popups.removeClass(self.classes.popupOpen),$("body").removeClass(self.classes.popupOpen)),self.active=!1})},Popup}(),popup=new Popup;